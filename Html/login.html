<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://kit.fontawesome.com/aed33b3770.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../css/login.css">
</head>
<body>
    <div>
        <div id="toastbox"></div>
        <div class="logo">
            <button id="logo">Readwave</button>
        </div>
        <div class="wrapper">
            <form>
                <div class="hb">
                    <h1>Login</h1>
                </div>
                <div class="input-box">
                    <input type="text" id="fname" name="fname" placeholder="username"><br>
                </div>
                <div class="input-box">
                    <input type="password" id="pwd" name="pwd" placeholder="password">
                </div>
                <button type="button" class="btn" onclick="login()">Login</button>
                <div class="register-link">
                    <p>Don't have an account? <a href="./signup.html">Register</a></p>
                </div>
            </form>
        </div>
    </div>

    <script>
        function displayToast(message, style, icon) {
            const toastbox = document.getElementById("toastbox");
            const toast = document.createElement("div");
            toast.className = style;
            toast.innerHTML = `<i class="${icon}"></i>${message}`;
            toastbox.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        function login() {
            try {
                const name = document.getElementById("fname").value;
                const password = document.getElementById("pwd").value;
                const storedData = localStorage.getItem("user") || "[]";
                const dataBase = JSON.parse(storedData);

                if (!name || !password) {
                    displayToast("Please fill in your details", "toast1", "fa-circle-check succ");
                } else {
                    const user = dataBase.find(user => user.fname === name && user.pwd === password);

                    if (user) {
                        displayToast("Login successful", "toast1", "fa-circle-check succ");
                        setTimeout(() => {
                            window.location.href = "Library.html";
                        }, 2000);
                    } else {
                        displayToast("Name not found or incorrect password", "toast2", "fa-circle-xmark fai");
                    }
                }
            } catch (error) {
                console.error("Error:", error);
                // Handle the error as needed
            }
        }

        const logo = document.getElementById("logo");
        logo.addEventListener('click', () => {
            window.location.href = "../index.html";
        });
    </script>

    <script src="https://unpkg.com/ionicons@4.5.10-0/dist/ionicons.js"></script>
</body>
</html>
